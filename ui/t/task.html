<sca-menutab menu="appconf.menu" active="'tasks'" user="user"></sca-menutab>
<div class="container-fluid">
    <h1>{{task.name}} <!--<small class="text-muted">{{task_id}}</small>--></h1>
    <tabset>
        <tab heading="Products" ng-show="task.status == 'finished'" active="tabs.products.active">
            <br>
            <div ng-repeat="product in task.products">
                <accordion close-others="true">
                    <accordion-group ng-repeat="file in product.files" heading="{{file.name}}">
                        <img style="max-height: 500px" ng-src="{{file.url}}">
                        <p>{{file.desc}}</p>
                    </accordion-group>
                </accordion>
            </div>
        </tab>
        <tab heading="Progress" ng-show="progress" active="tabs.progress.active">
            <a target="{{task._id}}" href="{{appconf.progress_url}}/#/detail/{{progress.key}}" class="pull-right">Show Progress Detail</a>
            <h3 style="text-transform: uppercase; font-weight: bold;">{{progress.status}} <i class="fa fa-spinner fa-pulse" ng-if="progress.status == 'running'"></i></h3>
            <p>{{progress.msg}}</p>
            <div ng-if="progress.status == 'running'">
                <progressbar value="progress.progress*100" type="{{progressType(progress.status)}}">{{progress.progress*100 | number:1}}%</progressbar>
                <!--ETA : <time>TODO</time>-->
            </div>

            <span class="text-muted">Requested at:</span> <time>{{progress.update_time|date:'medium'}}</time>
        </tab>
        <tab heading="Configuration" active="tabs.config.active">
            <br>
            <pre>{{task.config|json}}</pre>
        </tab>
        <tab heading="Debug" class="pull-right">
            <br>
            <h3>Task</h3>
            <pre>{{task|json}}</pre>
            <h3>Progress</h3>
            <pre>{{progress|json}}</pre>
        </tab>
        <!--
        <tab select="alertMe()">
            <br>
            <tab-heading>
            <i class="glyphicon glyphicon-bell"></i> Alert!
            </tab-heading>
            I've got an HTML heading, and a select callback. Pretty cool!
        </tab>
        -->
    </tabset>

    <div ng-if="progress.status == 'running'">
    </div>
</div>
